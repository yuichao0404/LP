# システム実装ガイド

## 目次
1. [システムアーキテクチャ概要](#システムアーキテクチャ概要)
2. [データフロー](#データフロー)
3. [API実装例](#api実装例)
4. [ワーカー画面UI設計](#ワーカー画面ui設計)
5. [クライアント画面UI設計](#クライアント画面ui設計)

---

## システムアーキテクチャ概要

### システム構成図

```
┌─────────────────────────────────────────────────────────┐
│                    クライアント側                          │
│  ┌──────────────────────────────────────────────┐       │
│  │ 商品情報入力フォーム                              │       │
│  │ - 商品名、カテゴリ、ターゲット、ベネフィット等      │       │
│  │ - 商品メイン画像アップロード                        │       │
│  └──────────────────────────────────────────────┘       │
│                         ↓                                │
│  ┌──────────────────────────────────────────────┐       │
│  │ LP型選択（自動提案 or 手動選択）                   │       │
│  │ - パターン1：説明型                                │       │
│  │ - パターン2：ニーズ想起型                           │       │
│  │ - パターン3：友達紹介型                             │       │
│  └──────────────────────────────────────────────┘       │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│                 バックエンド処理層                          │
│  ┌──────────────────────────────────────────────┐       │
│  │ ChatGPT API（GPT-4）                             │       │
│  │ - LP構成案生成                                      │       │
│  │ - 画像プロンプト生成                                 │       │
│  └──────────────────────────────────────────────┘       │
│                         ↓                                │
│  ┌──────────────────────────────────────────────┐       │
│  │ 画像生成API                                         │       │
│  │ - Midjourney API（画像2-4生成）                    │       │
│  │ - Canva指示書生成（画像1編集用）                    │       │
│  └──────────────────────────────────────────────┘       │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│                    ワーカー側                             │
│  ┌──────────────────────────────────────────────┐       │
│  │ LP編集画面                                          │       │
│  │ - AI生成テキストの人間味追加                         │       │
│  │ - 画像1のCanva編集                                  │       │
│  │ - 画像2-4のプロンプト微調整                          │       │
│  └──────────────────────────────────────────────┘       │
│                         ↓                                │
│  ┌──────────────────────────────────────────────┐       │
│  │ 完成・承認                                           │       │
│  └──────────────────────────────────────────────┘       │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│                 HTML/CSS変換 + 楽天RMS出力                │
│  - Markdown → HTML変換                                   │
│  - 楽天市場のページ仕様に合わせたCSS適用                    │
│  - 画像最適化（圧縮、リサイズ）                             │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│              クライアント確認・公開                         │
└─────────────────────────────────────────────────────────┘
```

---

## データフロー

### 1. クライアント入力 → LP型選択

**入力データ構造：**
```json
{
  "product_id": "PROD_12345",
  "product_info": {
    "name": "有機梅干し白湯パック",
    "category": "健康飲料・発酵食品",
    "target": "30-40代の健康意識が高い女性",
    "benefit": "代謝促進、美肌効果、便秘改善",
    "differentiation": "無添加・有機栽培梅使用、お湯を注ぐだけで簡単",
    "price": "1,980円（30包入り）",
    "main_image_url": "https://example.com/images/product_main.jpg"
  }
}
```

**LP型選択API：**
```python
POST /api/lp/select-pattern
Content-Type: application/json

{
  "product_info": { ... }
}

# レスポンス
{
  "recommended_pattern": 2,  # 1=説明型, 2=ニーズ想起型, 3=友達紹介型
  "reason": "健康飲料かつターゲットが明確なため、ニーズ想起型が最適です",
  "confidence": 0.87
}
```

---

### 2. LP構成案生成

**LP生成API：**
```python
POST /api/lp/generate
Content-Type: application/json

{
  "product_info": { ... },
  "pattern": 2  # 選択されたLP型
}

# レスポンス
{
  "lp_id": "LP_67890",
  "sections": [
    {
      "section_number": 1,
      "title": "最近注目の「発酵食品」について",
      "content": "最近SNSで話題になっている発酵食品。特に梅干しを使った...",
      "image_instruction": {
        "type": "canva_edit",
        "template_keywords": ["ブログアイキャッチ", "記事ヘッダー"],
        "placement": "right_align",
        "font_style": "明朝体・細め",
        "color_palette": ["#F5F1E8", "#B8E6D5"],
        "text_overlay": "最近話題の《発酵食品》で内側から整える"
      }
    },
    {
      "section_number": 2,
      "title": "期待できる嬉しい変化",
      "content": "【美肌効果】梅干しに含まれるクエン酸は...",
      "image_instruction": {
        "type": "ai_generation",
        "midjourney_prompt": "A subtle and relatable image representing...",
        "intent": "ターゲットが抱える「モヤモヤ」を視覚化",
        "adjustable_params": {
          "target_concern": "daily fatigue and lack of vitality",
          "visual_elements": "messy desk with empty coffee cup",
          "mood": "Not depressing, gentle everyday struggle"
        }
      }
    },
    // ... セクション3, 4
  ]
}
```

---

### 3. 画像生成プロンプト出力

**画像プロンプト生成API：**
```python
POST /api/images/generate-prompts
Content-Type: application/json

{
  "lp_id": "LP_67890",
  "product_info": { ... }
}

# レスポンス
{
  "image_prompts": [
    {
      "image_number": 1,
      "type": "canva_edit",
      "instruction": { ... }  # 上記のimage_instruction
    },
    {
      "image_number": 2,
      "type": "midjourney",
      "prompt": "A subtle and relatable image representing daily fatigue and lack of vitality. A slightly messy desk with an empty coffee cup, soft afternoon light, quiet room, feeling of mid-day tiredness. Not depressing, but showing a common everyday struggle in a gentle way. Natural indoor lighting, candid lifestyle photography, neutral color palette, relatable and authentic. Soft focus, documentary style, magazine editorial quality. --ar 16:9 --style raw --v 6",
      "adjustable_params": {
        "concern": "daily fatigue and lack of vitality",
        "scene": "slightly messy desk with an empty coffee cup",
        "time": "soft afternoon light",
        "mood": "mid-day tiredness"
      }
    },
    // ... 画像3, 4
  ]
}
```

---

## API実装例

### Python（Flask）実装例

```python
from flask import Flask, request, jsonify
import openai
import re

app = Flask(__name__)

# ChatGPT API設定
openai.api_key = "YOUR_API_KEY"

# プロンプトテンプレート読み込み
PATTERN_PROMPTS = {
    1: open('prompts/pattern1_explanation.txt', 'r', encoding='utf-8').read(),
    2: open('prompts/pattern2_needs_awakening.txt', 'r', encoding='utf-8').read(),
    3: open('prompts/pattern3_friend_recommendation.txt', 'r', encoding='utf-8').read()
}


# ===============================
# 1. LP型選択API
# ===============================
@app.route('/api/lp/select-pattern', methods=['POST'])
def select_lp_pattern():
    """
    商品情報から最適なLP型を自動選択
    """
    data = request.json
    product_info = data['product_info']
    
    selection_prompt = f"""
以下の商品情報から、最適なLP型を1つ選んでください。

商品名：{product_info['name']}
商品カテゴリ：{product_info['category']}
主要ターゲット：{product_info['target']}
主要ベネフィット：{product_info['benefit']}

選択肢：
1. 説明型 - 商品の機能・特徴を直接的に説明（機能性商品、新商品向け）
2. ニーズ想起型 - トレンドから入り、自然にニーズを喚起（ライフスタイル商品向け）
3. 友達紹介型 - カジュアルに「これいいよ」と推奨（トレンド商品、ギフト向け）

JSON形式で回答：
{{
  "pattern": 数字（1, 2, 3のいずれか）,
  "reason": "選択理由",
  "confidence": 信頼度（0.0-1.0）
}}
"""
    
    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[
            {"role": "system", "content": "あなたはマーケティングの専門家です。"},
            {"role": "user", "content": selection_prompt}
        ],
        temperature=0.3
    )
    
    result = response.choices[0].message.content
    # JSON抽出
    import json
    result_json = json.loads(result)
    
    return jsonify({
        "recommended_pattern": result_json['pattern'],
        "reason": result_json['reason'],
        "confidence": result_json['confidence']
    })


# ===============================
# 2. LP構成案生成API
# ===============================
@app.route('/api/lp/generate', methods=['POST'])
def generate_lp():
    """
    選択されたLP型でLP構成案を生成
    """
    data = request.json
    product_info = data['product_info']
    pattern = data['pattern']
    
    # プロンプトテンプレートを取得
    prompt_template = PATTERN_PROMPTS[pattern]
    
    # 商品情報を埋め込み
    filled_prompt = prompt_template.format(
        商品名=product_info['name'],
        カテゴリ=product_info['category'],
        ターゲット=product_info['target'],
        ベネフィット=product_info['benefit'],
        差別化=product_info['differentiation'],
        価格=product_info['price']
    )
    
    # ChatGPT API呼び出し
    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[
            {"role": "system", "content": "あなたは経験豊富なセールスライターです。"},
            {"role": "user", "content": filled_prompt}
        ],
        temperature=0.7,
        max_tokens=3000
    )
    
    lp_content = response.choices[0].message.content
    
    # Markdownをパースしてセクションごとに分割
    sections = parse_markdown_to_sections(lp_content)
    
    # LP IDを生成
    import uuid
    lp_id = f"LP_{uuid.uuid4().hex[:8]}"
    
    return jsonify({
        "lp_id": lp_id,
        "pattern": pattern,
        "sections": sections
    })


# ===============================
# 3. 画像プロンプト生成API
# ===============================
@app.route('/api/images/generate-prompts', methods=['POST'])
def generate_image_prompts():
    """
    LP構成案から画像生成プロンプトを出力
    """
    data = request.json
    lp_id = data['lp_id']
    product_info = data['product_info']
    
    # LP情報を取得（DB等から）
    # ここでは簡略化
    sections = data.get('sections', [])
    
    image_prompts = []
    
    for section in sections:
        section_num = section['section_number']
        
        if section_num == 1:
            # 画像1: Canva編集指示
            image_prompts.append({
                "image_number": 1,
                "type": "canva_edit",
                "instruction": section.get('image_instruction', {})
            })
        else:
            # 画像2-4: Midjourney生成
            raw_prompt = section.get('image_instruction', {}).get('midjourney_prompt', '')
            
            # プロンプト内の変数を商品情報で置換
            filled_prompt = fill_prompt_variables(
                raw_prompt,
                product_info,
                section_num
            )
            
            image_prompts.append({
                "image_number": section_num,
                "type": "midjourney",
                "prompt": filled_prompt,
                "adjustable_params": extract_adjustable_params(filled_prompt)
            })
    
    return jsonify({
        "lp_id": lp_id,
        "image_prompts": image_prompts
    })


# ===============================
# ヘルパー関数
# ===============================
def parse_markdown_to_sections(markdown_text):
    """
    Markdownテキストをセクションごとに分割
    """
    sections = []
    current_section = None
    
    lines = markdown_text.split('\n')
    
    for line in lines:
        if line.startswith('## セクション'):
            # 新しいセクション開始
            if current_section:
                sections.append(current_section)
            
            match = re.search(r'セクション(\d+)', line)
            section_num = int(match.group(1)) if match else len(sections) + 1
            
            current_section = {
                "section_number": section_num,
                "title": "",
                "content": "",
                "image_instruction": {}
            }
        elif line.startswith('**【画像'):
            # 画像指示開始
            continue
        elif current_section is not None:
            if line.startswith('#') and current_section['title'] == "":
                current_section['title'] = line.strip('#').strip()
            else:
                current_section['content'] += line + '\n'
    
    if current_section:
        sections.append(current_section)
    
    return sections


def fill_prompt_variables(prompt_template, product_info, section_number):
    """
    プロンプト内の{変数}を商品情報で置換
    """
    replacements = {
        '主要ベネフィット': translate_to_english(product_info['benefit']),
        'ベネフィットに関連する視覚要素': generate_visual_element(product_info, 'benefit'),
        'ターゲットの潜在的悩み': translate_to_english(f"{product_info['target']}の悩み"),
        # ... 他の変数
    }
    
    for key, value in replacements.items():
        prompt_template = re.sub(
            r'\{' + key + r'[^}]*\}',
            value,
            prompt_template
        )
    
    return prompt_template


def translate_to_english(japanese_text):
    """
    日本語を英語に翻訳（DeepL API使用想定）
    """
    # 実装例：DeepL API呼び出し
    # ここでは簡略化
    return japanese_text  # 実際には英訳結果を返す


def generate_visual_element(product_info, element_type):
    """
    商品情報から視覚要素を自動生成
    """
    prompt = f"""
以下の商品情報から、{element_type}を表す視覚要素を英語で生成してください。

商品カテゴリ：{product_info['category']}
ターゲット：{product_info['target']}

出力形式：「場所 + 物 + 状態」の組み合わせ
例）"A kitchen counter with breakfast dishes, morning light, sense of rushing"

回答（英語のみ）：
"""
    
    response = openai.ChatCompletion.create(
        model="gpt-4o-mini",
        messages=[
            {"role": "user", "content": prompt}
        ],
        temperature=0.5,
        max_tokens=100
    )
    
    return response.choices[0].message.content.strip()


def extract_adjustable_params(prompt):
    """
    プロンプトから調整可能なパラメータを抽出
    """
    params = {}
    
    # 正規表現で{}内の変数を抽出
    matches = re.findall(r'\{([^}]+)\}', prompt)
    for match in matches:
        key = match.split(':')[0].strip()
        value = match.split(':')[1].strip() if ':' in match else ""
        params[key] = value
    
    return params


if __name__ == '__main__':
    app.run(debug=True, port=5000)
```

---

## ワーカー画面UI設計

### 画面構成

```
┌─────────────────────────────────────────────────────────┐
│  ナビゲーション                                            │
│  [ダッシュボード] [進行中の案件] [完了済み] [プロフィール]   │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│  案件情報                                                 │
│  案件ID: #12345  |  商品名: 有機梅干し白湯パック           │
│  LP型: パターン2（ニーズ想起型） | 納期: 2024/12/31       │
│  進捗: 60% ███████░░░                                    │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│  セクション1：最近注目の「発酵食品」について                │
│                                                          │
│  【画像1編集】                                            │
│  ┌────────────────────────────────────────────┐         │
│  │  [商品メイン画像プレビュー]                      │         │
│  │                                                │         │
│  │  ▶ Canvaで編集する                             │         │
│  │    テンプレート：ブログアイキャッチ               │         │
│  │    配置：右寄せ                                  │         │
│  │    フォント：明朝体・細め                         │         │
│  └────────────────────────────────────────────┘         │
│                                                          │
│  【テキスト編集】                                          │
│  ┌────────────────────────────────────────────┐         │
│  │ 最近SNSで話題になっている発酵食品。特に梅干し    │         │
│  │ を使った健康法が注目されています。その中でも...  │         │
│  │                                                │         │
│  │ [編集モード] [AI再生成] [人間味チェック]         │         │
│  └────────────────────────────────────────────┘         │
│                                                          │
│  ✅ 人間味チェックポイント                                 │
│  □ 同じ語尾が3回以上連続していないか                       │
│  □ 具体的な数字や固有名詞を1つ追加できないか               │
│  □ 画像との整合性は問題ないか                             │
│                                                          │
│  [次のセクションへ] [一時保存]                             │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│  セクション2：期待できる嬉しい変化                          │
│                                                          │
│  【画像2生成】                                            │
│  ┌────────────────────────────────────────────┐         │
│  │  [AI生成画像プレビュー]                         │         │
│  │                                                │         │
│  │  Midjourneyプロンプト：                         │         │
│  │  "A subtle and relatable image..."            │         │
│  │                                                │         │
│  │  ▼ 調整可能パラメータ                            │         │
│  │  ターゲットの悩み: [daily fatigue]             │         │
│  │  シーン: [messy desk with coffee cup]         │         │
│  │  時間帯: [soft afternoon light]               │         │
│  │  雰囲気: [mid-day tiredness]                  │         │
│  │                                                │         │
│  │  [プロンプト編集] [再生成]                       │         │
│  └────────────────────────────────────────────┘         │
│                                                          │
│  【テキスト編集】                                          │
│  （セクション1と同様）                                     │
│                                                          │
│  [前のセクション] [次のセクションへ] [一時保存]              │
└─────────────────────────────────────────────────────────┘

（セクション3、4も同様）

┌─────────────────────────────────────────────────────────┐
│  完成・提出                                               │
│                                                          │
│  ✅ 最終チェック                                          │
│  □ 全4枚の画像に統一感があるか                            │
│  □ テキストに人間味が追加されているか                      │
│  □ 画像とテキストの内容が矛盾していないか                  │
│  □ ファイルサイズは適切か（各500KB以下）                  │
│                                                          │
│  [プレビュー表示] [クライアントに提出]                      │
└─────────────────────────────────────────────────────────┘
```

---

## クライアント画面UI設計

### 画面構成

```
┌─────────────────────────────────────────────────────────┐
│  新規LP作成                                               │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│  商品情報入力                                             │
│                                                          │
│  商品名： [                                    ]          │
│  商品カテゴリ： [                              ]          │
│  主要ターゲット： [                            ]          │
│  主要ベネフィット： [                          ]          │
│  差別化ポイント： [                            ]          │
│  価格帯： [                                    ]          │
│                                                          │
│  商品メイン画像：                                          │
│  ┌────────────────────────────────────────────┐         │
│  │  [ドラッグ&ドロップでアップロード]             │         │
│  │  または [ファイルを選択]                      │         │
│  └────────────────────────────────────────────┘         │
│                                                          │
│  [次へ：LP型選択]                                         │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│  LP型選択（AIによる推奨）                                  │
│                                                          │
│  おすすめLP型：パターン2（ニーズ想起型）                    │
│  理由：健康飲料かつターゲットが明確なため                   │
│  信頼度：87%                                              │
│                                                          │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐              │
│  │ パターン1 │  │ パターン2 │  │ パターン3 │              │
│  │ 説明型    │  │ ニーズ想起│  │ 友達紹介  │              │
│  │         │  │  ★推奨   │  │         │              │
│  └─────────┘  └─────────┘  └─────────┘              │
│                                                          │
│  [LP生成開始]                                             │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│  LP生成中...                                              │
│                                                          │
│  ✓ 商品情報の分析完了                                      │
│  ✓ LP構成案の生成完了                                      │
│  ⏳ 画像プロンプトの生成中...                               │
│                                                          │
│  進捗: 75% ████████░░                                    │
│  推定残り時間: 30秒                                        │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│  LP作成依頼完了                                            │
│                                                          │
│  案件ID: #12345                                           │
│  ステータス: ワーカー編集中                                 │
│  納期目安: 2024/12/31                                      │
│                                                          │
│  ワーカーが編集を完了次第、確認依頼が届きます。             │
│                                                          │
│  [案件一覧に戻る]                                          │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│  LP確認・承認                                              │
│                                                          │
│  案件ID: #12345  |  商品名: 有機梅干し白湯パック           │
│  ステータス: 確認待ち                                       │
│                                                          │
│  ┌────────────────────────────────────────────┐         │
│  │  [LPプレビュー表示]                            │         │
│  │                                                │         │
│  │  セクション1：最近注目の「発酵食品」について      │         │
│  │  [画像1] ...テキスト内容...                    │         │
│  │                                                │         │
│  │  セクション2：期待できる嬉しい変化               │         │
│  │  [画像2] ...テキスト内容...                    │         │
│  │                                                │         │
│  │  ...                                           │         │
│  └────────────────────────────────────────────┘         │
│                                                          │
│  [修正依頼] [承認・公開]                                   │
└─────────────────────────────────────────────────────────┘
```

---

## データベース設計

### テーブル構造

```sql
-- クライアント（楽天セラー）
CREATE TABLE clients (
    client_id VARCHAR(50) PRIMARY KEY,
    shop_name VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 商品情報
CREATE TABLE products (
    product_id VARCHAR(50) PRIMARY KEY,
    client_id VARCHAR(50) REFERENCES clients(client_id),
    name VARCHAR(255) NOT NULL,
    category VARCHAR(100),
    target VARCHAR(255),
    benefit TEXT,
    differentiation TEXT,
    price VARCHAR(50),
    main_image_url TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- LP案件
CREATE TABLE lp_projects (
    lp_id VARCHAR(50) PRIMARY KEY,
    product_id VARCHAR(50) REFERENCES products(product_id),
    client_id VARCHAR(50) REFERENCES clients(client_id),
    pattern INT,  -- 1=説明型, 2=ニーズ想起型, 3=友達紹介型
    status VARCHAR(50),  -- 'generating', 'worker_editing', 'client_review', 'completed'
    worker_id VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    completed_at TIMESTAMP
);

-- LPセクション
CREATE TABLE lp_sections (
    section_id VARCHAR(50) PRIMARY KEY,
    lp_id VARCHAR(50) REFERENCES lp_projects(lp_id),
    section_number INT,
    title VARCHAR(255),
    content TEXT,
    image_url TEXT,
    image_instruction JSON,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ワーカー
CREATE TABLE workers (
    worker_id VARCHAR(50) PRIMARY KEY,
    name VARCHAR(100),
    email VARCHAR(255),
    skill_level INT,  -- 1-5
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 作業ログ
CREATE TABLE work_logs (
    log_id VARCHAR(50) PRIMARY KEY,
    lp_id VARCHAR(50) REFERENCES lp_projects(lp_id),
    worker_id VARCHAR(50) REFERENCES workers(worker_id),
    action VARCHAR(100),  -- 'text_edit', 'image_generate', 'submit'
    details JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## デプロイメント構成

### インフラ構成例（AWS）

```
┌─────────────────────────────────────────────────────────┐
│  フロントエンド                                            │
│  - React.js / Next.js                                    │
│  - Hosting: Vercel または AWS S3 + CloudFront            │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  API Gateway                                             │
│  - AWS API Gateway                                       │
│  - 認証: AWS Cognito                                      │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  バックエンド                                             │
│  - Lambda Functions (Python 3.11)                        │
│  - または EC2 (Flask/FastAPI)                            │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  データベース                                             │
│  - AWS RDS (PostgreSQL)                                  │
│  - または DynamoDB                                        │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  ストレージ                                               │
│  - AWS S3 (画像保存)                                      │
│  - CloudFront (CDN)                                      │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  外部API                                                 │
│  - OpenAI API (ChatGPT)                                  │
│  - Midjourney API                                        │
│  - DeepL API (翻訳)                                       │
└─────────────────────────────────────────────────────────┘
```

---

## セキュリティ対策

### 1. 認証・認可
- **JWT（JSON Web Token）**による認証
- クライアントとワーカーで異なる権限レベル
- API Keyの暗号化保存

### 2. データ保護
- 商品情報の暗号化（AWS KMS）
- 画像ファイルのアクセス制限（署名付きURL）
- 定期的なバックアップ

### 3. API制限
- レートリミット設定（1分間に10リクエストまで）
- IPホワイトリスト
- 異常検知・アラート

---

このシステム実装ガイドに従えば、楽天LP作成自動化ツールの基本機能を構築できます。
